# Prometheus (standalone) - Lab Configuration
# Chart: prometheus 27.0.0

prometheus:
  # Disable components we don't need
  alertmanager:
    enabled: false

  prometheus-pushgateway:
    enabled: false

  kube-state-metrics:
    enabled: false

  prometheus-node-exporter:
    enabled: false

  # Prometheus server
  server:
    service:
      type: LoadBalancer

    # Enable remote write receiver for Alloy/Tempo
    extraFlags:
      - "web.enable-remote-write-receiver"

    persistentVolume:
      enabled: true
      storageClass: "gp3"
      size: 10Gi

    resources:
      requests:
        cpu: 250m
        memory: 512Mi
      limits:
        cpu: 500m
        memory: 1Gi

  # Scrape automation-api (namespace api). Using extraScrapeConfigs so the chart
  # appends this directly to scrape_configs; scrapeConfigs map was not making it into the live config.
  extraScrapeConfigs: |
    - job_name: automation-api
      metrics_path: /metrics
      static_configs:
        - targets:
            - automation-api.api.svc.cluster.local:80
          labels:
            namespace: api
            service: automation-api
